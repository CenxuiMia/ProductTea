<!DOCTYPE html>
<html lang="en">
<head>
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta charset="UTF-8">
    <title>產品頁面</title>
    <!--[if IE 8]>
    <script type="text/javascript" src="build/ie8.js"></script>
    <![endif]-->
    <link href='//fonts.googleapis.com/css?family=Lato' rel='stylesheet' type='text/css'>

    <link href="build/Squire-UI.css" rel="stylesheet" type="text/css" />
    <link href="dist/css/bootstrap.css" rel="stylesheet" type="text/css" />
    <link href="dist/css/fileinput.min.css" rel="stylesheet" type="text/css">
    <script src="auth.js"></script>
    <script src="build/jQuery/jQuery.js" type="text/javascript"></script>
    <script src="build/squire.js" type="text/javascript"></script>
    <script src="build/Squire-UI.js" type="text/javascript"></script>
    <script src="dist/js/fileinput.min.js" type="text/javascript"></script>

</head>
<body>



<div class="container">
    <input id="productName" placeholder="productName">
    <div></div>
    <input id="version" placeholder="version">
    <div></div>
    <input id="price" placeholder="price">
    <div></div>
    <input id="originalPrice" placeholder="originalPrice">
    <div></div>
    <input id="introduction" placeholder="introduction">
    <div></div>
    <input id="tag" placeholder="tag">
    <div></div>
    <input id="smailImage" placeholder="smailImage">
    <div></div>
    <input id="images" placeholder="images">


    <div class="row">
        <div class="col-centered">
            <label for="detail">detail</label>
            <textarea id="detail"></textarea>
        </div>
    </div>

    <form enctype="multipart/form-data">
        <input name="file" type="file" />
        <input type="button" value="Upload" />
    </form>

    <div></div>

    <button onclick="updateProduct()">確定</button><button>取消</button>
</div>
</body>

<script>

    $(document).ready(function () {
        detail = new SquireUI({replace: 'textarea#detail', height: 200});
    });

    function updateProduct() {
        console.info(detail.getHTML())

        let product = {
            productName: document.getElementById("productName").value,
            version: document.getElementById("version").value,
            price: document.getElementById("price").value,
            originalPrice: document.getElementById("originalPrice").value,
            introduction: document.getElementById("introduction").value,
//            tag: document.getElementById("tag").value,
//            smallImage: document.getElementById("smallImage").value,
//            images: document.getElementById("images").value,
        }

        let productJson = JSON.stringify(product);

        console.info(productJson);

        $.ajax({
            type : 'PUT',
            url : productEndpoint + "/table",
            data : productJson,
            success : function(response) {
                console.info("success");
            },
            error : function(xhr, status, error) {
                console.log("error: " + error + ", status: " + status);

            }
        });


    }


    $(':file').on('change', function() {
        var file = this.files[0];
        let len = Object.keys($('input[type=file]')[0].files).length;
        console.info(len)

    });

    $(':button').on('click', function() {

        var oReq = new XMLHttpRequest();
        oReq.open("POST", productEndpoint + "/image", true);
        oReq.setRequestHeader("productName", "ice");
        oReq.setRequestHeader("version", "black");
        oReq.setRequestHeader("fileName", "mia");
        oReq.onload = function (oEvent) {
            console.info(oEvent)
        };

        var blob = new Blob([$('input[type=file]')[0].files[0]]);

        oReq.send(blob)

    });

    function upload() {

        $.ajax({
            // Your server script to process the upload
            headers: {
                productName : "ice",
                version : "red",
                fileName : "small",
            },
            type: "POST",
            url: productEndpoint + "/image",
            enctype: 'multipart/form-data',
            // Form data
            data: new FormData($('form')[0]),

            // Tell jQuery not to process data or worry about content-type
            // You *must* include these options!
            cache: false,
            contentType: false,
            processData: false,
            success : function(response) {
                console.info(response);
            },
            error : function(xhr, status, error) {
                console.log("error: " + error + ", status: " + status);

            }
        });
    }

</script>

</html>


